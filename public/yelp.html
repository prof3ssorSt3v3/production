<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Yelp Fusion API</title>
</head>
<body>
    <div id="output"></div>
    <script>
        document.addEventListener('DOMContentLoaded', ()=>{
            let geoOptions = {
                enableHighAccuracy: true, 
                timeout: 20000, 
                maximumAge: 1000};
            
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    let lat = position.coords.latitude; 
                    let lng = position.coords.longitude;
                    let h = new Headers();
                    h.append('Authorization', 'Bearer 8VTnBc1Vkj2dVYwanWsTOCaIIZ7A2P-4a-3TREpHWaIiq6hJHW_u2e8N2G0CsrXTdIlgxezBWC4S7sEAzsl07pYozOu-beutYoC_bbbacr7XSijk0RFRr-OSrXf0W3Yx');
                    
                    //h.append("Authorization", "Bearer i9nYwwn8J1L1FGXdz8VePQi6810dQT-qxCMnhrcm8M9gxsZF2GpfpV5zJw0QmTx5EBuyZk5GHA2JxPXporsiw9H0TP_oPB1y4REmIYpIG8lsIWOuTYD0ELccBJg2WnYx");
                    
                    let url = "https://api.yelp.com/v3/businesses/search?latitude=" + lat + "&longitude=" + lng + '&categories=restaurants&locale=en_CA';

                    let options = { method: 'GET',
                               headers: h,
                               mode: 'cors',
                               cache: 'default' };

                    let req = new Request(url, options);

                    fetch(req)
                    .then(res => res.json() )
                    .then( data => {
                        console.log('FETCH DATA')
                        console.log(data);
                    })
                    .catch(err=>{
                        console.error('fetch: ', err.message);
                    })
                },
                (error) =>{ 
                    console.error(error.message)
                },
                geoOptions
            );
        })
    </script>
</body>
</html>